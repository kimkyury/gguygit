---
import EchoesPostLayout from '../../layouts/EchoesPostLayout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const entries = await getCollection('echoes');
  return entries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry }
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const formatDate = (date) => date.toISOString().slice(0, 10).replace(/-/g, '.');
---

<EchoesPostLayout
  title={entry.data.title}
  date={formatDate(entry.data.date)}
  datePublished={entry.data.date.toISOString()}
  rating={entry.data.rating}
  youtube={entry.data.youtube}
  cover={entry.data.cover}
  summary={entry.data.summary}
>
  <Content />
</EchoesPostLayout>

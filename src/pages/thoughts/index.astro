---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const entries = (await getCollection('record')).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
const formatDate = (date: Date) =>
  date.toISOString().slice(0, 10).replace(/-/g, '.');
---

<BaseLayout title="Thoughts">
  <section class="record-list">
    <header class="list-header">
      <h1>단상</h1>
      <p>그때그때 떠오른 생각의 토막토막</p>
    </header>

    {entries.length === 0 ? (
      <p class="empty">아직 기록 포스팅이 없습니다.</p>
    ) : (
      <ul class="list">
        {entries.map((entry) => (
          <li>
            <a href={`/thoughts/${entry.slug}`}>
              <span class="date">{formatDate(entry.data.date)}</span>
              <span class="title">{entry.data.title}</span>
              {entry.data.summary && <span class="summary">{entry.data.summary}</span>}
            </a>
          </li>
        ))}
      </ul>
    )}
  </section>
</BaseLayout>

<style>
  .record-list {
    display: grid;
    gap: 24px;
  }

  .list-header h1 {
    margin: 0;
    font-family: 'JN_leanring', var(--font-display);
    font-size: clamp(2rem, 4vw, 3rem);
  }

  .list-header p {
    margin: 8px 0 0;
    color: var(--color-muted);
  }

  .list {
    list-style: none;
    margin: 0;
    padding: 0;
    display: grid;
    gap: 12px;
  }

  .list li {
    border-top: 1px solid rgba(27, 26, 23, 0.12);
  }

  .list a {
    display: grid;
    grid-template-columns: 110px 1fr;
    gap: 12px;
    padding: 12px 0;
    text-decoration: none;
    color: inherit;
  }

  .date {
    font-size: 0.8rem;
    color: var(--color-muted);
    letter-spacing: 0.14em;
    text-transform: uppercase;
  }

  .title {
    font-size: 1.05rem;
    font-weight: 500;
  }

  .summary {
    grid-column: 2 / -1;
    color: var(--color-muted);
    font-size: 0.9rem;
  }

  .empty {
    color: var(--color-muted);
  }
</style>
